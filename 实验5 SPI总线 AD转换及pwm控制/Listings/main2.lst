C51 COMPILER V9.56.0.0   MAIN2                                                             11/27/2018 16:20:24 PAGE 1   


C51 COMPILER V9.56.0.0, COMPILATION OF MODULE MAIN2
OBJECT MODULE PLACED IN .\Objects\main2.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE main2.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\mai
                    -n2.lst) TABS(2) OBJECT(.\Objects\main2.obj)

line level    source

   1          #include "XPT2046.h"
   2          
   3          typedef unsigned int u16;
   4          typedef unsigned char u8;
   5          
   6          sbit LED = P2^7;
   7          sbit LSA=P2^2;
   8          sbit LSB=P2^3;
   9          sbit LSC=P2^4;
  10          u8 code smgduan[10]={0x3f,0x06,0x5b,0x4f,0x66,0x6d,0x7d,0x07,0x7f,0x6f};
  11          u8 DisplayData[4];
  12          u16 ad_value;
  13          u8 cycleCount = 0;
  14          int count = 1;
  15          u8 threshold = 0;
  16          void delay(u16 i)
  17          {
  18   1        while(i--); 
  19   1      }
  20          
  21          void DigDisplay()
  22          {
  23   1        u8 i;
  24   1        for(i=0;i<4;i++)
  25   1        {
  26   2          switch(i)
  27   2          {
  28   3            case(0):
  29   3              LSA=1;LSB=1;LSC=1; break;
  30   3            case(1):
  31   3              LSA=0;LSB=1;LSC=1; break;
  32   3            case(2):
  33   3              LSA=1;LSB=0;LSC=1; break;
  34   3            case(3):
  35   3              LSA=0;LSB=0;LSC=1; break;
  36   3          }
  37   2          P0=DisplayData[3-i];
  38   2          delay(60);  
  39   2          P0=0x00;
  40   2        }   
  41   1      }
  42          
  43          void read(){
  44   1        if(cycleCount == 25)
  45   1        {
  46   2          cycleCount = 0;
  47   2          ad_value = Read_AD_Data(0x94);
  48   2          threshold = ad_value/41;
  49   2          DisplayData[0] = smgduan[ad_value%10];
  50   2          DisplayData[1] = smgduan[ad_value%100/10];
  51   2          DisplayData[2] = smgduan[ad_value%1000/100];
  52   2          DisplayData[3] = smgduan[ad_value/1000];
  53   2        }
  54   1        cycleCount++;
C51 COMPILER V9.56.0.0   MAIN2                                                             11/27/2018 16:20:24 PAGE 2   

  55   1      }
  56          
  57          void main() {
  58   1        TMOD = 0x02;
  59   1        TH0 = 0xa0;
  60   1        TL0 = 0xa0;
  61   1        TR0 = 1;
  62   1        ET0 = 1;
  63   1        EA = 1;
  64   1        while(1) {
  65   2          read();
  66   2          DigDisplay();
  67   2        }
  68   1      }
  69          
  70          timer0() interrupt 1
  71          {
  72   1        count++;
  73   1        if(count > 100) {
  74   2          count = 1;
  75   2        }
  76   1        if(count > threshold) {
  77   2          LED = 1;
  78   2        }else{
  79   2          LED = 0;
  80   2        }
  81   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    315    ----
   CONSTANT SIZE    =     10    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     10    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
